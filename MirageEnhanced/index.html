<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Mirage Online Classic - Dual Account</title>
<style>
  /* Reset and base */
  body, html {
    margin: 0; padding: 0; height: 100%; overflow: hidden;
    background: #000;
    font-family: Arial, sans-serif;
  }
  iframe {
    position: absolute;
    left: 0;
    width: 100%;
    height: 100%;
    border: none;
    pointer-events: auto;
    transition: top 0.3s, height 0.3s;
  }
  #gameIframeMain {
    top: 0;
    z-index: 0;
  }
  #gameIframeAlt {
    top: 0;
    z-index: 0;
    display: none;
  }

  /* Top bar container */
  #topBarContainer {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 40px;
    background: rgba(0, 0, 0, 0.85);
    border-bottom: 1px solid #0f0;
    color: #0f0;
    display: flex;
    align-items: center;
    padding: 0 10px;
    gap: 12px;
    font-size: 14px;
    box-sizing: border-box;
    z-index: 100000;
    user-select: none;
    transition: transform 0.3s ease;
    transform: translateY(-100%);
  }
  #topBarContainer.visible {
    transform: translateY(0);
  }

  /* Buttons */
  .bar-button {
    background: transparent;
    border: 1px solid #0f0;
    border-radius: 5px;
    color: #0f0;
    cursor: pointer;
    padding: 4px 10px;
    font-size: 14px;
    user-select: none;
    transition: background-color 0.2s, color 0.2s;
  }
  .bar-button:hover {
    background-color: #0f0;
    color: #000;
  }

  /* Tab buttons container */
  #tabButtons {
    display: flex;
    gap: 6px;
  }
  .tab-button {
    background: transparent;
    border: 1px solid #0f0;
    border-radius: 5px;
    color: #0f0;
    cursor: pointer;
    padding: 4px 12px;
    font-size: 14px;
    user-select: none;
    transition: background-color 0.2s, color 0.2s;
  }
  .tab-button.active {
    background-color: #0f0;
    color: #000;
  }
  .tab-button:hover:not(.active) {
    background-color: rgba(0,255,0,0.3);
  }

  /* Toggle button for the top bar */
  #toggleBarBtn {
    position: fixed;
    top: 5px;
    right: 5px;
    width: 30px;
    height: 30px;
    background: rgba(0,0,0,0.7);
    border: 1px solid #0f0;
    border-radius: 5px;
    color: #0f0;
    font-size: 20px;
    line-height: 28px;
    text-align: center;
    cursor: pointer;
    user-select: none;
    z-index: 100001;
    transition: background-color 0.2s, color 0.2s;
  }
  #toggleBarBtn:hover {
    background-color: #0f0;
    color: #000;
  }

  /* Wiki buttons container inside top bar */
  #wikiButtons {
    display: flex;
    gap: 8px;
  }
  #wikiButtons button {
    background: transparent;
    border: 1px solid #0f0;
    border-radius: 5px;
    color: #0f0;
    padding: 4px 10px;
    cursor: pointer;
    font-size: 14px;
    user-select: none;
    transition: background-color 0.2s, color 0.2s;
  }
  #wikiButtons button:hover {
    background-color: #0f0;
    color: #000;
  }

  /* Wiki iframe overlay */
  #wikiOverlay {
    position: fixed;
    top: 10%;
    left: 10%;
    width: 80%;
    height: 80%;
    background: #111;
    border: 2px solid #0f0;
    border-radius: 10px;
    box-shadow: 0 0 30px #0f0;
    z-index: 100002;
    display: none;
    flex-direction: column;
  }
  #wikiOverlay iframe {
    flex: 1;
    border: none;
    border-radius: 0 0 10px 10px;
    width: 100%;
    height: 100%;
    pointer-events: auto;
  }
  #wikiOverlay #wikiCloseBtn {
    background: #000;
    color: #0f0;
    border: none;
    font-size: 20px;
    cursor: pointer;
    padding: 4px 12px;
    border-radius: 10px 10px 0 0;
    user-select: none;
  }
  #wikiOverlay #wikiCloseBtn:hover {
    background: #0f0;
    color: #000;
  }
</style>
</head>
<body>

<!-- Toggle button for the top bar -->
<div id="toggleBarBtn" title="Show Controls">ðŸ“š</div>

<!-- Top bar container (hidden initially) -->
<div id="topBarContainer" aria-hidden="true" aria-label="Controls">
  <div id="systemTime"></div>

  <div id="tabButtons" role="tablist" aria-label="Account Tabs">
    <button class="tab-button active" data-iframe="main" role="tab" aria-selected="true" tabindex="0">Main</button>
    <button class="tab-button" data-iframe="alt" role="tab" aria-selected="false" tabindex="-1">Alt</button>
  </div>

  <div id="wikiButtons">
    <button id="itemLookupBtn" title="Item Lookup">Item Lookup</button>
    <button id="npcLookupBtn" title="NPC Lookup">NPC Lookup</button>
  </div>
</div>

<!-- Game iframes -->
<iframe id="gameIframeMain" src="https://play.consty.com" sandbox="allow-scripts allow-same-origin allow-forms" aria-label="Main Game Frame"></iframe>
<iframe id="gameIframeAlt" src="https://play.consty.com" sandbox="allow-scripts allow-same-origin allow-forms" aria-label="Alternate Account Frame"></iframe>

<!-- Wiki iframe overlay -->
<div id="wikiOverlay" role="dialog" aria-modal="true" aria-labelledby="wikiCloseBtn">
  <button id="wikiCloseBtn" title="Close Wiki">âœ–</button>
  <iframe src="" frameborder="0" scrolling="auto" aria-label="Wiki Content"></iframe>
</div>

<script>
(() => {
  const toggleBarBtn = document.getElementById("toggleBarBtn");
  const topBarContainer = document.getElementById("topBarContainer");
  const systemTimeDiv = document.getElementById("systemTime");
  const iframeMain = document.getElementById("gameIframeMain");
  const iframeAlt = document.getElementById("gameIframeAlt");

  const tabButtons = document.querySelectorAll("#tabButtons .tab-button");

  const wikiButtons = document.getElementById("wikiButtons");
  const itemLookupBtn = document.getElementById("itemLookupBtn");
  const npcLookupBtn = document.getElementById("npcLookupBtn");

  const wikiOverlay = document.getElementById("wikiOverlay");
  const wikiCloseBtn = document.getElementById("wikiCloseBtn");
  const wikiIframe = wikiOverlay.querySelector("iframe");

  // Show/hide top bar & resize iframes accordingly
  function showTopBar(show) {
    if(show){
      topBarContainer.classList.add("visible");
      topBarContainer.setAttribute("aria-hidden", "false");
      iframeMain.style.top = "40px";
      iframeAlt.style.top = "40px";
      iframeMain.style.height = "calc(100% - 40px)";
      iframeAlt.style.height = "calc(100% - 40px)";
    } else {
      topBarContainer.classList.remove("visible");
      topBarContainer.setAttribute("aria-hidden", "true");
      iframeMain.style.top = "0";
      iframeAlt.style.top = "0";
      iframeMain.style.height = "100%";
      iframeAlt.style.height = "100%";
    }
  }

  // Toggle bar button click
  toggleBarBtn.addEventListener("click", () => {
    const isVisible = topBarContainer.classList.contains("visible");
    showTopBar(!isVisible);
  });

  // Update system time every second
  function updateTime() {
    const now = new Date();
    const h = now.getHours().toString().padStart(2, "0");
    const m = now.getMinutes().toString().padStart(2, "0");
    const s = now.getSeconds().toString().padStart(2, "0");
    systemTimeDiv.textContent = `Time: ${h}:${m}:${s}`;
  }
  updateTime();
  setInterval(updateTime, 1000);

  // Tab switching logic
  function switchTab(name) {
    tabButtons.forEach(btn => {
      const isActive = btn.dataset.iframe === name;
      btn.classList.toggle("active", isActive);
      btn.setAttribute("aria-selected", isActive ? "true" : "false");
      btn.tabIndex = isActive ? 0 : -1;
    });

    if(name === "main"){
      iframeMain.style.display = "block";
      iframeAlt.style.display = "none";
      iframeMain.focus();
    } else if(name === "alt"){
      iframeMain.style.display = "none";
      iframeAlt.style.display = "block";
      iframeAlt.focus();
    }
  }

  tabButtons.forEach(btn => {
    btn.addEventListener("click", () => {
      switchTab(btn.dataset.iframe);
    });
  });

  // Default to main tab
  switchTab("main");

  // Wiki overlay controls
  function openWikiPage(url) {
    wikiIframe.src = url;
    wikiOverlay.style.display = "flex";

    // Disable pointer events on game iframes to prevent interaction
    iframeMain.style.pointerEvents = "none";
    iframeAlt.style.pointerEvents = "none";
  }
  function closeWiki() {
    wikiOverlay.style.display = "none";
    wikiIframe.src = "";
    iframeMain.style.pointerEvents = "auto";
    iframeAlt.style.pointerEvents = "auto";
  }

  itemLookupBtn.addEventListener("click", () => {
    openWikiPage("https://loociez.github.io/MOC-IV/itemslast.html");
  });
  npcLookupBtn.addEventListener("click", () => {
    openWikiPage("https://loociez.github.io/MOC-IV/npclast.html");
  });
  wikiCloseBtn.addEventListener("click", closeWiki);

  // Prevent click fallthrough on wiki overlay
  wikiOverlay.addEventListener("click", e => e.stopPropagation());
})();
</script>

</body>
</html>
